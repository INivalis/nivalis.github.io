<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Hollow~</title>
  <style>
    /* =====================================================
       You are the warmth hidden inside my cold silence, 
       the glow that reminds me Iâ€™m not lost

       Just know that I think of you, again and again, 
       as if my soul only knows one direction... towards you.

       Yours, always

       Nivalis~
       ===================================================== */ 

    :root{
      --u: 1vmin;
      --gap-bottom: calc(max(16px, 4vh) + env(safe-area-inset-bottom));
      --bg-desktop: url('assets/images/bg-desktop.jpg');
      --bg-mobile:  url('assets/images/bg-mobile.jpg');
      --dialog-maxw: min(83vw, 1400px);
      --dialog-vpad: clamp(8px, 1.2vmin, 16px);
      --dialog-hpad: clamp(10px, 2.5vmin, 18px);
    }

    html, body{ margin:0; padding:0; height:100%; overflow:hidden; background:#000; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial; }

    body::before{ content:""; position:fixed; inset:0; background:var(--bg-desktop) center/cover no-repeat fixed; z-index:0; }
    @media(orientation:portrait){ body::before{ background:var(--bg-mobile) center/cover no-repeat fixed; } }

    /* Overlay de inicio para mi Venus~ */
    .start-overlay{ position:fixed; inset:0; display:grid; place-items:center; z-index:10050; background:#06121d; opacity:1; transition:opacity .8s ease; }
    .start-overlay.fade-out{ opacity:0; pointer-events:none; }
    .start-card{ text-align:center; padding:clamp(24px, 4vmin, 40px); }
    .start-title{ color:#cbd5e1; font-weight:300; font-size:clamp(16px,3.2vmin,28px); letter-spacing:.14em; opacity:.85; animation:floaty 5s ease-in-out infinite, softBlink 3.4s ease-in-out infinite; }
    @keyframes floaty{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }
    @keyframes softBlink{ 0%,100%{opacity:.95} 50%{opacity:.6} }

    @media (prefers-reduced-motion: reduce){
      .start-title, .sing-cta, #dialog{ animation:none !important; }
      .start-overlay, #blackout{ transition:none !important; }
    }

    /* Dialogos para mi Venus */
    #dialog{ position:fixed; left:50%; bottom:var(--gap-bottom); transform:translateX(-50%); display:inline-block; width:max-content; max-width:var(--dialog-maxw); box-sizing:border-box; padding:var(--dialog-vpad) var(--dialog-hpad); border-radius:20px; background:rgba(150,200,255,.30); color:#fff; font-size:clamp(14px,2.2vmin,22px); line-height:1.4; text-align:center; text-shadow:0 0 8px #00ffe7; z-index:2; user-select:none; cursor:default; animation:floatDialog 3s ease-in-out infinite; will-change:transform; }
    #dialogText{ white-space:normal; overflow-wrap:break-word; }
    @keyframes floatDialog{ 0%,100%{transform:translate(-50%,0)} 50%{transform:translate(-50%,-10px)} }

    /* Nieve para mi... hihi */
    #snowCanvas{ position:fixed; inset:0; z-index:1200; pointer-events:none; display:block; }

    /* Venus~ moach */
    .sing-cta{ position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); z-index:1005; padding:var(--dialog-vpad) var(--dialog-hpad); border-radius:20px; border:none; background:rgba(150,200,255,.30); color:#fff; font-size:clamp(14px,2.2vmin,22px); line-height:1.4; text-align:center; cursor:pointer; opacity:0; pointer-events:none; transition:opacity .35s ease, transform .2s ease; text-shadow:0 0 8px #00ffe7; animation:floatDialog 3s ease-in-out infinite; will-change:transform; }
    .sing-cta.show{ opacity:1; pointer-events:auto; }
    .sing-cta:active{ transform:translate(-50%,-50%) scale(.98); }

    /* Lyrics/scroll */
    .lyrics-overlay{ position:fixed; inset:0; z-index:1006; display:none; color:#eaf7ff; background: radial-gradient(120% 160% at 50% 35%, rgba(0,12,24,.12), rgba(0,0,0,.30)); backdrop-filter: blur(7px); -webkit-backdrop-filter: blur(7px); }
    .lyrics-overlay.show{ display:block; animation:fadeIn .4s ease; }
    .lyrics-panel{ max-width:min(92vw,1000px); height:80vh; margin:8vh auto; padding:22px 24px; border-radius:18px; background:transparent; backdrop-filter:none; box-shadow:none; display:flex; flex-direction:column; }
    .lyrics-title{ font-size:clamp(16px,2.4vmin,22px); font-weight:500; opacity:.92; text-align:center; margin-bottom:12px; letter-spacing:.12em; text-shadow:0 0 6px rgba(180,230,255,.18); }
    .lyrics-scroll{ flex:1; overflow-y:auto; padding:10px 6px 12vh; scroll-behavior:smooth; -webkit-overflow-scrolling:touch; scrollbar-width:thin; scrollbar-color: rgba(235,245,255,.38) transparent; scrollbar-gutter:stable both-edges; }
    .lyrics-line{ font-size:clamp(16px,2.6vmin,26px); line-height:1.55; text-align:center; margin:10px 0; text-shadow:0 0 6px rgba(0,255,231,.20); }

    /* Blackout final */
    #blackout{ position:fixed; inset:0; background:#000; z-index:2000; opacity:0; pointer-events:none; transition:opacity .8s ease; display:flex; align-items:center; justify-content:center; }
    #blackout.show{ opacity:1; pointer-events:auto; }
    #outroText{ color:#e5f7ff; font-size:clamp(18px,3vmin,28px); text-align:center; opacity:0; transition:opacity .8s ease; padding:0 8vw; text-shadow:0 0 12px rgba(0,255,231,.3); }
    #outroText.show{ opacity:1; }

    @keyframes fadeIn{ from{opacity:0} to{opacity:1} }
    .lyrics-scroll::after{ content:""; display:none; }
      /* Desktop scrollbar estilo para mis lyrics */
  @media (hover:hover) and (pointer:fine){
    .lyrics-scroll::-webkit-scrollbar{ width:8px; height:8px; }
    .lyrics-scroll::-webkit-scrollbar-track{ background:transparent; }
    .lyrics-scroll::-webkit-scrollbar-thumb{ background:rgba(235,245,255,.38); border-radius:999px; border:2px solid transparent; background-clip:padding-box; }
    .lyrics-scroll::-webkit-scrollbar-thumb:hover{ background:rgba(235,245,255,.55); }
  }
    .lyrics-footer{ font-size:clamp(12px,1.8vmin,16px); opacity:.65; letter-spacing:.12em; text-align:center; margin-top:10px; font-style:italic; text-shadow:0 0 6px rgba(180,230,255,.12); }
  </style>
</head>
<body>
  <!-- Overlay de inicio -->
  <div id="startOverlay" class="start-overlay" role="dialog" aria-modal="true" aria-label="Soft Collapse start">
    <div class="start-card">
      <div class="start-title">Soft Collapseâ€¦</div>
    </div>
  </div>

  <!-- Audios -->
  <audio id="sonidoViento"  src="assets/audio/sfx/viento.mp3" preload="auto"></audio>
  <audio id="musicaFondo"   src="assets/audio/bgm/musica.mp3" preload="auto" loop></audio>
  <audio id="coverAudio"    src="assets/audio/bgm/cover.mp3"  preload="auto"></audio>
  <audio id="overlayBreath1" src="assets/audio/sfx/overlay-breath-1.mp3" preload="auto"></audio>
  <audio id="overlayBreath2" src="assets/audio/sfx/overlay-breath-2.mp3" preload="auto"></audio>
  <audio id="overlayBreath3" src="assets/audio/sfx/overlay-breath-3.mp3" preload="auto"></audio>
  <audio id="overlayBreath4" src="assets/audio/sfx/overlay-breath-4.mp3" preload="auto"></audio>

  <!-- Canvas nieve -->
  <canvas id="snowCanvas" aria-hidden="true"></canvas>

  <!-- Dialogo -->
  <div id="dialog" role="status" aria-live="polite"><span id="dialogText"></span></div>

  <!-- Para cantar -->
  <button id="ctaSing" class="sing-cta" hidden aria-haspopup="dialog" aria-controls="lyricsOverlay">Sing with me!</button>

  <!-- Lyrics overlay -->
  <div id="lyricsOverlay" class="lyrics-overlay" hidden role="dialog" aria-modal="true" aria-label="Lyrics panel">
    <div class="lyrics-panel">
      <div class="lyrics-title">Cry For Me (feat. æ„›æµ·)</div>
      <div id="lyricsScroll" class="lyrics-scroll"></div>
      <div class="lyrics-footer">Nivalis~</div>
  </div>

  <!-- Blackout final -->
  </div>

  <div id="blackout" hidden aria-hidden="true">
    <div id="outroText"></div>
  </div>

  <script>
  'use strict';
  // GitHub Pages
  (function(){
    var baseDir = (location.pathname||'').replace(/[^\/]+$/, '');
    function withBase(p){ if(!p) return p; if(/^https?:/i.test(p)) return p; p = String(p).replace(/^\//,''); return baseDir + p; }
    
    try{
      var root = document.documentElement;
      root.style.setProperty('--bg-desktop', 'url("'+withBase('assets/images/bg-desktop.jpg')+'")');
      root.style.setProperty('--bg-mobile',  'url("'+withBase('assets/images/bg-mobile.jpg')+'")');
    }catch(e){}
    
    window.addEventListener('DOMContentLoaded', function(){
      ['sonidoViento','musicaFondo','coverAudio','overlayBreath1','overlayBreath2','overlayBreath3','overlayBreath4'].forEach(function(id){
        var el = document.getElementById(id); if(!el) return; var attr = el.getAttribute('src'); if(!attr) return; if(/^\/?assets\//.test(attr)) el.setAttribute('src', withBase(attr));
      });
    });
    
    var _fetch = window.fetch; window.fetch = function(input, init){
      var url = (typeof input === 'string')? input : (input && input.url) || '';
      if(/^\/?assets\//.test(url)) url = withBase(url);
      if(typeof input === 'string') return _fetch(url, init);
      try{ var req = new Request(url, input); return _fetch(req, init);}catch(e){ return _fetch(url, init);} };
  })();
  const $ = (sel)=>document.querySelector(sel);

  /* ==================== Nieve ==================== */
  (function snow(){
    const cvs = $('#snowCanvas'); if(!cvs) return; const ctx = cvs.getContext('2d');
    let dpr = Math.max(1, window.devicePixelRatio||1), W=0, H=0;
    function resize(){ W=innerWidth; H=innerHeight; dpr=Math.max(1, devicePixelRatio||1); cvs.width=Math.floor(W*dpr); cvs.height=Math.floor(H*dpr); cvs.style.width=W+'px'; cvs.style.height=H+'px'; ctx.setTransform(dpr,0,0,dpr,0,0); init(); }
    addEventListener('resize', resize);

    const SPR=32;
    const snowSprite = document.createElement('canvas'); snowSprite.width=snowSprite.height=SPR; const sctx=snowSprite.getContext('2d'); const gS=sctx.createRadialGradient(SPR/2,SPR/2,0,SPR/2,SPR/2,SPR/2); gS.addColorStop(0,'rgba(255,255,255,.95)'); gS.addColorStop(1,'rgba(255,255,255,0)'); sctx.fillStyle=gS; sctx.beginPath(); sctx.arc(SPR/2,SPR/2,SPR/2,0,Math.PI*2); sctx.fill();
    const petalSprite = document.createElement('canvas'); petalSprite.width=petalSprite.height=SPR; const pctx=petalSprite.getContext('2d'); const gP=pctx.createRadialGradient(SPR/2,SPR/2,0,SPR/2,SPR/2,SPR/2); gP.addColorStop(0,'rgba(247,198,208,.95)'); gP.addColorStop(1,'rgba(225,124,161,0)'); pctx.fillStyle=gP; pctx.beginPath(); pctx.arc(SPR/2,SPR/2,SPR/2,0,Math.PI*2); pctx.fill();

    const PETAL_RATIO=0.30; let flakes=[];
    function newFlake(y=Math.random()*H, kind){
      const isPetal = kind? kind==='petal' : Math.random()<PETAL_RATIO;
      if(isPetal){ const w=4+Math.random()*10, h=w*(0.55+Math.random()*0.35), vy=0.8+Math.random()*1.2, sway=0.6+Math.random()*1.4, spin=(Math.random()<.5?1:-1)*(0.01+Math.random()*0.03); return {kind:'petal',x:Math.random()*W,y,w,h,vy,sway,angle:Math.random()*Math.PI*2,rot:Math.random()*Math.PI*2,spin}; }
      const isBig=Math.random()<0.12, r=isBig?2.2+Math.random()*1.6:1.0+Math.random()*1.4, vy=isBig?0.6+Math.random()*0.8:1.0+Math.random()*1.4, sway=0.4+Math.random()*1.2; return {kind:'snow',x:Math.random()*W,y,r,vy,sway,angle:Math.random()*Math.PI*2};
    }
    function init(){ const area=W*H, density=0.00070, count=Math.max(140, Math.min(600, Math.round(area*density))); flakes=new Array(count).fill(0).map(()=>newFlake(Math.random()*H)); }
    let wind=0,target=0; function updateWind(){ if(Math.random()<0.006) target=(Math.random()*2-1)*0.35; wind+=(target-wind)*0.01; }
    function step(){ updateWind(); ctx.clearRect(0,0,W,H); for(let i=0;i<flakes.length;i++){ const f=flakes[i]; if(f.kind==='petal'){ f.angle+=0.02*f.sway; f.rot+=f.spin; f.x+=Math.sin(f.angle)*(0.6+f.sway*0.2)+wind*0.8; f.y+=f.vy*(0.85+0.3*Math.sin(f.angle+f.rot*0.5)); if(f.x<-8)f.x=W+8; if(f.x>W+8)f.x=-8; if(f.y>H+8){ flakes[i]=newFlake(-8,'petal'); continue; } ctx.save(); ctx.translate(f.x,f.y); ctx.rotate(f.rot+Math.sin(f.angle*1.7)*0.4); ctx.globalAlpha=0.95; ctx.drawImage(petalSprite,-f.w/2,-f.h/2,f.w,f.h); ctx.restore(); } else { f.angle+=0.01*f.sway; f.x+=Math.sin(f.angle)*0.3+wind; f.y+=f.vy; if(f.x<-6)f.x=W+6; if(f.x>W+6)f.x=-6; if(f.y>H+6){ flakes[i]=newFlake(-6,'snow'); continue; } const size=f.r*2; ctx.globalAlpha=0.85; ctx.drawImage(snowSprite,f.x-f.r,f.y-f.r,size,size); } } requestAnimationFrame(step); }
    resize(); requestAnimationFrame(step);
  })();

  /* ==================== Audio helpers ==================== */
  const viento=$('#sonidoViento'), musica=$('#musicaFondo'), cover=$('#coverAudio');
  const breath1=$('#overlayBreath1'), breath2=$('#overlayBreath2'), breath3=$('#overlayBreath3'), breath4=$('#overlayBreath4');
  function playBreath(n){
    try{
      const a = n===1?breath1 : n===2?breath2 : n===3?breath3 : n===4?breath4 : null;
      if(!a) return;
      a.currentTime=0;
      a.volume = n===1?0.18 : n===2?0.22 : n===3?0.28 : 0.30; // I miss you Venus~
      a.play().catch(()=>{});
    }catch(e){}
  }
  function reproducirViento(){ if(!viento||viento.dataset.running==='1')return; viento.dataset.running='1'; viento.loop=true; const start=0.010,target=0.020,step=200,dur=5000; viento.volume=start; viento.currentTime=0; const p=viento.play(); if(p?.then) p.then(()=>{ let t=0; const id=setInterval(()=>{t+=step; const k=Math.min(1,t/dur); viento.volume=start+(target-start)*k; if(k>=1) clearInterval(id);}, step); }).catch(()=>{}); }
  function iniciarMusica(){ if(!musica)return; const start=0.002,target=0.07,step=200,dur=10000; musica.volume=start; const p=musica.play(); if(p?.then) p.then(()=>{ let t=0; const id=setInterval(()=>{ t+=step; const k=Math.min(1,t/dur); musica.volume=start+(target-start)*k; if(k>=1) clearInterval(id);}, step); }).catch(()=>{}); }
  function fadeOut(audio,dur){ if(!audio)return; const step=100; let t=0; const start=Math.max(0,Math.min(1,audio.volume||0)); const id=setInterval(()=>{ t+=step; const k=Math.min(1,t/dur); audio.volume=start*(1-k); if(k>=1){ clearInterval(id); try{ audio.pause(); }catch(e){} audio.volume=start; } }, step); }

  /* ==================== Loader ==================== */
  const qs=new URLSearchParams(location.search);
  function pickLang(s){ const t=(s||'').toLowerCase(); if(t.startsWith('es'))return'es'; if(t.startsWith('vi'))return'vi'; if(t.startsWith('ja')||t.startsWith('jp'))return'ja'; if(t.startsWith('en'))return'en'; return'en'; }
  const LANG=pickLang(qs.get('lang')||navigator.language);
  async function loadLines(lang=LANG){ const urls=[`assets/data/dialogs/${lang}/hollow.json`,`assets/data/dialogs/en/hollow.json`,`assets/data/dialogos/${lang}/hollow.json`,`assets/data/dialogos/en/hollow.json`]; for(const url of urls){ try{ const res=await fetch(url,{cache:'no-store'}); if(res.ok){ const data=await res.json(); if(Array.isArray(data.lines)) return data.lines; if(Array.isArray(data.phrases)) return data.phrases; if(Array.isArray(data.phases)&&data.phases[0]?.lines) return data.phases[0].lines; } }catch(e){} } return ["(no hay diÃ¡logos)"]; }

  /* ==================== Typer ==================== */
  let frases=["(no hay diÃ¡logos)"];
  const dialog=$('#dialog'), dialogText=$('#dialogText');
  const typer={ i:0, typing:false, pos:0, speed:50, timer:null, current:'', type(str){ this.typing=true; this.pos=0; this.current=String(str||''); dialogText.textContent=''; clearInterval(this.timer); const s=this.current; this.timer=setInterval(()=>{ if(this.pos>=s.length){ clearInterval(this.timer); this.typing=false; return; } dialogText.textContent+=s.charAt(this.pos++); }, this.speed); }, skip(){ if(!this.typing) return; clearInterval(this.timer); dialogText.textContent=this.current; this.typing=false; } };

  /* ==================== Overlay ==================== */
  const startOverlay=$('#startOverlay');
  const startTitle=startOverlay?startOverlay.querySelector('.start-title'):null;
  const overlayPhrases=['Soft Collapseâ€¦','Hollow Dreamâ€¦','Whispers of Nothingâ€¦','Step into Nivalisâ€¦'];
  let overlayIndex=0, lastTap=0; if(startTitle) startTitle.textContent=overlayPhrases[0];
  function ensureAudio(){ reproducirViento(); iniciarMusica(); }
  function beginOverlay(){ if(!startOverlay || startOverlay.classList.contains('fade-out')) return; startOverlay.classList.add('fade-out'); setTimeout(()=>{ try{ startOverlay.remove(); }catch(e){} startStory(); }, 900); }
  function advanceOverlay(){ const now=Date.now(); if(now-lastTap<300) return; lastTap=now; const n=overlayIndex+1; playBreath(n); if(overlayIndex<overlayPhrases.length-1){ overlayIndex++; if(startTitle) startTitle.textContent=overlayPhrases[overlayIndex]; return; } ensureAudio(); beginOverlay(); }
  if(startOverlay) startOverlay.addEventListener('pointerdown', e=>{ e.preventDefault(); e.stopPropagation(); advanceOverlay(); }, {passive:false});
  document.addEventListener('keydown', e=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); advanceOverlay(); }});

  /* ==================== Historia ==================== */
  let storyStarted=false;
  async function startStory(){ if(storyStarted) return; storyStarted=true; dialogText.textContent=''; try{ frases=await loadLines(LANG); }catch(e){ frases=["(no hay diÃ¡logos)"]; } typer.i=0; typer.type(frases[0]||''); }
  window.addEventListener('load', ()=>{ if(dialogText) dialogText.textContent=''; });

  /* Avance/ skip; termino/siguiente; */
  function overlayActivo(){ const el=$('#startOverlay'); return el && document.body.contains(el) && !el.classList.contains('fade-out'); }
  function handleAdvance(){ if(overlayActivo() || !storyStarted) return; if(typer.typing){ typer.skip(); return; } if(typer.i < frases.length-1){ typer.i++; typer.type(frases[typer.i]||''); } else { showSingCTA(); } }
  document.addEventListener('click', handleAdvance);
  document.addEventListener('keydown', e=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); handleAdvance(); } });

  /* ==================== Sing sing sing ==================== */
  const ctaSing=$('#ctaSing'), lyricsOverlay=$('#lyricsOverlay'), lyricsScroll=$('#lyricsScroll'), blackout=$('#blackout'), outroText=$('#outroText');
  const LYRICS=[
  'ã‚ãªãŸã¯å¤•æ—¥ã«æº¶ã‘ã¦',
'ã‚ãŸã—ã¯å¤œæ˜Žã«æ¶ˆãˆã¦',
'ã‚‚ã†äºŒåº¦ã¨ äº¤ã‚ã‚‰ãªã„ã®ãªã‚‰',
'ãã‚ŒãŒé‹å‘½ã ã­',
'ã‚ãªãŸã¯ç¯ã¨ã‚‚ã—ã¦',
'ã‚ãŸã—ã¯å…‰ã‚‚ã¨ã‚ã¦',
'æ€–ãã¯ãªã„ å¤±ã†ã‚‚ã®ãªã©ãªã„',
'æœ€åˆã‹ã‚‰ä½•ã‚‚æŒã£ã¦ãªã„',
'ãã‚Œã˜ã‚ƒ ãã‚Œã˜ã‚ƒ ã¾ãŸã­',
'å°‘å¹´ã®çž³ã¯æ±šã‚Œ',
'5æ™‚ã®é˜ã¯é³´ã‚ŠéŸ¿ã‘ã© ã‚‚ã†èžã“ãˆãªã„',
'ãã‚Œã˜ã‚ƒ ãã‚Œã˜ã‚ƒ ã¾ã‚‹ã§',
'å…¨éƒ¨ çµ‚ã‚ã£ãŸã¿ãŸã„ã ã­',
'å¤§é–“é•ã„ å…ˆã¯é•·ã„ å¿˜ã‚Œãªã„ã‹ã‚‰',
'ã‚ã‚ å…¨ã¦å¿˜ã‚Œã¦å¸°ã‚ã†',
'ã‚ã‚ å…¨ã¦æµã—ã¦å¸°ã‚ã†',
'ã‚ã®å‚·ã¯ç–¼ã‘ã© ã“ã®æ¸‡ãç™’ãˆã­ã©',
'ã‚‚ã†ã©ã†ã§ã‚‚ã„ã„ã® å¹ãé£›ã°ãã†',
'ã•ã‚ã‚„ã‹ãªé¢¨ã¨å¸°ã‚ã†',
'ã‚„ã•ã—ãé™ã‚‹é›¨ã¨å¸°ã‚ã†',
'æ†Žã¿ã‚ã„ã®æžœã¦ã«ä½•ãŒç”Ÿã¾ã‚Œã‚‹ã®',
'ã‚ãŸã— ã‚ãŸã—ãŒå…ˆã« å¿˜ã‚Œã‚ˆã†',
'ã‚ãªãŸã¯å¼±éŸ³ã‚’åã„ã¦',
'ã‚ãŸã—ã¯æœªç·´ã“ã¼ã—ã¦',
'æœ€å¾Œãã‚‰ã„ ç¥žæ§˜ã§ã„ã•ã›ã¦',
'ã ã£ã¦ ã“ã‚Œã˜ã‚ƒäººé–“ã ',
'ã‚ãŸã—ã®ã„ãªã„ä¸–ç•Œã‚’',
'ä¸Šã‹ã‚‰çœºã‚ã¦ã„ã¦ã‚‚',
'ä½•ä¸€ã¤ å¤‰ã‚ã‚‰ãšå›žã‚‹ã‹ã‚‰',
'å°‘ã—èƒŒä¸­ãŒè»½ããªã£ãŸ',
'ãã‚Œã˜ã‚ƒ ãã‚Œã˜ã‚ƒ ã¾ãŸã­',
'å›½é“æ²¿ã„å‰ã§åˆ¥ã‚Œ',
'ç¶šãç”ºã®å–§é¨’ å¾Œç›®ã«ä¸€äººè¡Œã',
'ãã ã•ã„ ãã ã•ã„ ã°ã£ã‹ã§',
'ä½•ã‚‚ ã‚ã’ã‚‰ã‚Œãªã‹ã£ãŸã­',
'ç”Ÿãã¦ããŸ æ„å‘³ãªã‚“ã‹ åˆ†ã‹ã‚‰ãªã„ã¾ã¾',
'ã‚ã‚ å…¨ã¦ä¸Žãˆã¦å¸°ã‚ã†',
'ã‚ã‚ ä½•ã‚‚æŒãŸãšã«å¸°ã‚ã†',
'ä¸Žãˆã‚‰ã‚Œã‚‹ã‚‚ã®ã“ã ä¸Žãˆã‚‰ã‚ŒãŸã‚‚ã®',
'ã‚ã‚ŠãŒã¨ã† ã£ã¦èƒ¸ã‚’ã¯ã‚ã†',
'å¾…ã£ã¦ã‚‹ã‹ã‚‰ã• ã‚‚ã†å¸°ã‚ã†',
'å¹¸ã›çµ¶ãˆã¬å ´æ‰€ å¸°ã‚ã†',
'åŽ»ã‚Šéš›ã®æ™‚ã« ä½•ãŒæŒã£ã¦ã„ã‘ã‚‹ã®',
'ä¸€ã¤ä¸€ã¤ è·ç‰© æ‰‹æ”¾ãã†',
'æ†Žã¿åˆã„ã®æžœã¦ã«ä½•ãŒç”Ÿã¾ã‚Œã‚‹ã®',
'ã‚ãŸã— ã‚ãŸã—ãŒå…ˆã« å¿˜ã‚Œã‚ˆã†',
'ã‚ãä»Šæ—¥ã‹ã‚‰ã©ã†ç”Ÿãã¦ã“ã†'
];
  const OUTRO_LINE='Send me this â„ðŸª¼ðŸŒ·';
  let ctaShown=false;
  function showSingCTA(){ if(!ctaSing || ctaShown) return; ctaShown=true; try{ if(dialog) dialog.style.display='none'; }catch(e){} ctaSing.hidden=false; requestAnimationFrame(()=> ctaSing.classList.add('show')); }
  function startSong(){
    try{ if(ctaSing){ ctaSing.classList.remove('show'); ctaSing.hidden=true; } }catch(e){}
    try{ if(dialog){ dialog.style.display='none'; } }catch(e){}
    fadeOut(musica,1200); fadeOut(viento,1500);
    if(lyricsOverlay){ lyricsOverlay.hidden=false; lyricsOverlay.classList.add('show'); }
    if(lyricsScroll){ lyricsScroll.innerHTML=''; for(const line of LYRICS){ const p=document.createElement('p'); p.className='lyrics-line'; p.textContent=line; lyricsScroll.appendChild(p); } lyricsScroll.scrollTop=0; }
    if(cover){ setTimeout(()=>{ try{ cover.currentTime=0; }catch(e){} const start=0.02,target=0.85,step=100,dur=4000; let t=0; cover.volume=start; const pr=cover.play(); if(pr?.then) pr.catch(()=>{}); const id=setInterval(()=>{ t+=step; const k=Math.min(1,t/dur); cover.volume=start+(target-start)*k; if(k>=1) clearInterval(id); }, step); cover.onended=()=>beginFinale(); }, 500); }
  }
  function beginFinale(){ try{ if(lyricsOverlay){ lyricsOverlay.classList.remove('show'); setTimeout(()=> lyricsOverlay.hidden=true, 400); } }catch(e){} if(blackout){ blackout.hidden=false; requestAnimationFrame(()=> blackout.classList.add('show')); } if(outroText){ outroText.textContent=OUTRO_LINE; requestAnimationFrame(()=> outroText.classList.add('show')); } }
  if(ctaSing) ctaSing.addEventListener('click', startSong);
  </script>
</body>
</html>
